"use strict";const userInput=document.querySelector(".js-userInput"),searchButton=document.querySelector(".js-searchButton"),resetButton=document.querySelector(".js-resetButton"),listSeries=document.querySelector(".js-listSeries"),listFav=document.querySelector(".js-listFav"),resetFavButton=document.querySelector(".js-resetFavButton");let series=[],favorites=[];function getDataApi(){fetch("https://api.jikan.moe/v4/anime?q="+userInput.value).then(e=>e.json()).then(e=>{series=e.data,console.log(series),renderSeries()})}const imageSource2replace="https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png";function renderSeries(){let e="";for(const t of series){e+=`<li class="js-search-id" id="${t.mal_id}">`;let r=`<div><img src=${t.images.jpg.image_url}></div>`;null!==t.images.jpg.image_url&&t.images.jpg.image_url!==imageSource2replace||(r='<div><img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"></div>'),e+=r,e+=`<h3>${t.title}</h3>`,e+="</li>"}listSeries.innerHTML=e,handleClickFav()}function add2FavList(e){const t=e.currentTarget.id,r=findSerie(t,series);findSerie(t,favorites)?(e.currentTarget.classList.remove("new-color"),favorites.splice(favorites.indexOf(r),1),localStorage.setItem("favorites",JSON.stringify(favorites))):(e.currentTarget.classList.add("new-color"),saveFavorite(r))}function findSerie(e,t){return e=parseInt(e),t.find(t=>t.mal_id===e)}function saveFavorite(e){favorites.push(e),localStorage.setItem("favorites",JSON.stringify(favorites))}function getFromLocalStorage(){JSON.parse(localStorage.getItem("favorites"))?(favorites=JSON.parse(localStorage.getItem("favorites")),renderFav(series)):(listFav.innerHTML="",localStorage.removeItem("favorites"))}function renderFav(){let e="";for(const t of favorites){e+=`<li class="js-search-id" id="${t.mal_id}">`;let r=`<div><img src=${t.images.jpg.image_url}></div>`;null!==t.images.jpg.image_url&&t.images.jpg.image_url!==imageSource2replace||(r='<div><img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"></div>'),e+=r,e+=`<h3>${t.title}</h3>`,e+='<button type="button" class="js-clear-btn">X</button>',e+="</li>"}listFav.innerHTML=e,removeFromFavList()}function removeFromList(e){const t=findSerie(e.currentTarget.parentElement.id,favorites);favorites.splice(favorites.indexOf(t),1),localStorage.setItem("favorites",JSON.stringify(favorites)),listFav.removeChild(e.currentTarget.parentElement),renderFav()}function resetFavlist(){listFav.innerHTML="",favorites=[],localStorage.removeItem("favorites"),getFromLocalStorage()}function resetSearchResults(){userInput.value="",listSeries.innerHTML="",series=[]}function handleClick(e){e.preventDefault(),getDataApi()}function resetClick(e){e.preventDefault(),resetSearchResults()}function resetFav(e){e.preventDefault(),resetFavlist()}function handleClickFav(){const e=document.querySelectorAll(".js-search-id");for(const t of e)t.addEventListener("click",add2FavList),t.addEventListener("click",renderFav)}function removeFromFavList(){const e=document.querySelectorAll(".js-clear-btn");for(const t of e)t.addEventListener("click",removeFromList)}getFromLocalStorage(),removeFromFavList(),searchButton.addEventListener("click",handleClick),resetButton.addEventListener("click",resetClick),resetFavButton.addEventListener("click",resetFav);